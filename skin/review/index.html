<style type="text/css">
    .fix {display:block !important; margin:auto !important;}
    .pets_info {position:relative; margin-top:50px; text-align:center; display: inline-block;}
    .pets_info div {float:left; width:220px; height:185px; border:2px solid #e2e2e2; border-radius:8px; margin-right:20px;cursor: pointer}
    div.goods_list ul li {list-style:none; width:227px; height:293px; border:2px solid #e2e2e2; border-radius:10px;}
    div.goods_list ul li span {height:45px;}

    div.goods_list ul li img.goods_img{height:175px; width:224px; cursor:pointer;}
    div.goods_list ul li span {height: 45px; display: block; text-align: center; border-bottom: 1px solid #ccc;}
    div.goods_list ul li div .star img {height:17px;}
    div.goods_list ul li div .like {display:inline-block; margin-left:12px; margin-right:20px;}
    div.goods_list ul li div .comment {display:inline-block}

    .modal.fade .modal-content .modal-header {background:#452b78;color: white; font-weight: bold;}
    .modal.fade .modal-content .modal-header button.close{color:white;}
    .modal.fade .modal-content .modal-footer button {background:#452b78; color:white; border:none;}
    .modal div.goods_list .goods_img { width: 135px !important; height: 125px !important; margin-right: 15px !important; float: left !important; margin-top: 11px !important; }
    .modal div.goods_list .review_form .review_explain {width: 220px !important; float: left !important; margin-left: 17px !important;}
    .modal div.goods_list .review_form .review_explain span.explain{ display: block !important; font-size: 14px !important; }
    .star_rating {display:block;}
    .rating {
        overflow: hidden;
        display: inline-block;
    }

    .rating-input {
        float: right;
        width: 16px;
        height: 16px;
        padding: 0;
        margin: 0 0 0 -16px;
        opacity: 0;
    }
    .rating:hover .rating-star:hover,
    .rating:hover .rating-star:hover ~ .rating-star,
    .rating-input:checked ~ .rating-star {
        background-position: 0 0;
    }

    .rating-star,
    .rating:hover .rating-star {
        position: relative;
        float: right;
        display: block;
        width: 16px;
        height: 16px;
        background: url('/img/common/star.png') 0 -16px;
    }
</style>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<div class="contents">
    <h2 class="title">간식 평가하기</h2>
    <div class="fix"></div>
    <div class="pets_info">
        <?php if (!empty($pet_list)) : ?>
        <?php foreach($pet_list as $k => $pet){?>
            <div class="pet" data-pet_idx="<?php echo $pet['pet_idx']?>">
                <img src="<?php echo $pet['img_src']?>">
            </div>
        <?php }?>
        <?php endif; ?>
        <a href="/petManage/"><img src="/img/review/add_btn.png" alt="펫 추가"></a>
    </div>
    <div class="fixable" style="margin-top:70px border:1px solid black; width:150px;"></div>
    <div class="goods_list" style="margin-top:67px;">
        <div style="margin-top:70px; margin-bottom:30px; text-align:center; color:#452b78; font-size:26px;">
            <?php echo $pet_list[0]['name']?>가 여태까지 먹은 간식들
        </div>
        <?php if (!empty($goods_list)) : ?>
            <ul>
                <?php foreach ($goods_list as $k => $value) :
                $goods_img_arr = explode('|',$value['goods_img']);
                ?>
                    <li data-pet_idx="<?=$value['pet_idx']?>" >
                        <img class="goods_img" src="<?=base_url().$value['goods_img']?>" >
                        <span style="height:45px;"><?=$goods_img_arr[0]?></span>
                        <div style="height:74px !important;">
                            <div class="star">
                                <img src="/img/common/bg_star.png" alt="별점" />
                            </div>
                            <div class="like">
                                <img src="/img/review/like.png" alt="또 받고싶어요!">
                            </div>
                            <div class="comment">
                                <img src="/img/review/comment.png" alt="코멘트쓰기" data-toggle="modal" data-target="#exampleModalLong" data-goods_idx="<?=$value['goods_idx']?>">
                            </div>
                        </div>
                    </li>
                <?php endforeach; ?>
            </ul>
        <?php else : ?>
            <p>구매 작성할 상품이 없습니다.</p>
        <?php endif; ?>
    </div>

    <!-- Modal -->
    <form action="/review/register/" method="post" name="review_form">
        <div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
            <input type="hidden" name="goods_idx" value="">
            <input type="hidden" name="order_idx" value="">
            <input type="hidden" name="score_level" value="">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">코멘트 쓰기</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="review_form">
                            <div>
                                <img src="" class="goods_img" alt="이미지" style="width:135px; height:125px; margin-right:15px;">
                                <div class="review_explain">
                                    <span class="star_rating">
                                        <span class="rating">
                                            <input type="radio" class="rating-input"
                                                   id="rating-input-1-5" name="rating-input-1">
                                            <label for="rating-input-1-5" class="rating-star" value="5"></label>
                                            <input type="radio" class="rating-input"
                                                   id="rating-input-1-4" name="rating-input-1" value="4">
                                            <label for="rating-input-1-4" class="rating-star"></label>
                                            <input type="radio" class="rating-input"
                                                   id="rating-input-1-3" name="rating-input-1" value="3">
                                            <label for="rating-input-1-3" class="rating-star"></label>
                                            <input type="radio" class="rating-input"
                                                   id="rating-input-1-2" name="rating-input-1" value="2">
                                            <label for="rating-input-1-2" class="rating-star"></label>
                                            <input type="radio" class="rating-input"
                                                   id="rating-input-1-1" name="rating-input-1" value="1">
                                            <label for="rating-input-1-1" class="rating-star"></label>
                                        </span>
                                    </span>
                                    <span class="explain">알록달록 간식에 대한 생각을 자유롭게 표현해 주세요.</span>
                                    <textarea class="form-control" name="comment"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">확인</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<script type="text/javascript">
    $(document).ready(function(){
        $(".goods_list ul li .comment img").click(function(){
//            var src = $(this).find("img").attr("src");
            var src = $(this).parents().find("img.goods_img").attr("src");
            $(".modal-content .review_form img.goods_img").attr("src", src);
            $("form[name=review_form] input[name=goods_idx]").val($(this).data("goods_idx"));
        });
    });
</script>